---
title: "R-Shiny App for Sexing Leach's Storm-Petrels"
author: "Autumn Pauly"
date: "12/31/2024"
output: html_document
---
# Introduction for the Leach's Storm-Petrel Sex Prediction Tool

Welcome to the Leach’s Storm-Petrel Sex Prediction Tool!

This tool is designed to assist field researchers and ecologists in predicting the sex of Leach’s Storm-Petrels using morphometric measurements. Leach’s Storm-Petrels are monomorphic seabirds, meaning males and females appear nearly identical. However, subtle differences in certain physical traits, such as chord length, can provide valuable clues for determining sex.

The predictions generated by this tool are based on a logistic regression model derived from field data collected on Great Duck Island, Maine in 2024 by Autumn Pauly (paulyautumn@gmail.com). While molecular sexing methods remain the gold standard for accuracy, this tool offers a cost-effective and practical alternative for fieldwork, especially in remote locations.

# R-Shiny App
```{r}
# Load the Shiny library
library(shiny)

# Logistic regression coefficients from your model
intercept <- 185.647  
coef_chord <- -1.368  
coef_head <- 0.465   
coef_culmen <- 0.957 

# Define the UI
ui <- fluidPage(
  titlePanel("Leach's Storm-Petrel Sex Prediction"),
  
  sidebarLayout(
    sidebarPanel(
      numericInput("chord", "Chord Length (mm):", value = NA, step = 0.1),
      numericInput("head", "Head Length (mm):", value = NA, step = 0.1),
      numericInput("culmen", "Culmen Length (mm):", value = NA, step = 0.1),
      actionButton("predict", "Predict Sex")
    ),
    
    mainPanel(
      h3("Prediction Results"),
      textOutput("result"),
      textOutput("probability")
    )
  )
)

# Define the server
server <- function(input, output) {
  
  # Reactive expression to calculate probability
  prediction <- reactive({
    input$predict  # Trigger calculation when the button is clicked
    
    # Ensure inputs are not empty
    if (is.na(input$chord) || is.na(input$head) || is.na(input$culmen)) {
      return(list(probability = NA, classification = "Please provide all measurements."))
    }
    
    # Logistic regression equation
    logit <- intercept + coef_chord * input$chord +
             coef_head * input$head +
             coef_culmen * input$culmen
    probability <- exp(logit) / (1 + exp(logit))  # Convert logit to probability
    
    # Classification based on probability
    classification <- ifelse(probability > 0.5, "Male", "Female")
    
    return(list(probability = probability, classification = classification))
  })
  
  # Render the results
  output$result <- renderText({
    result <- prediction()
    if (!is.na(result$probability)) {
      paste("Classification:", result$classification)
    } else {
      result$classification
    }
  })
  
  output$probability <- renderText({
    result <- prediction()
    if (!is.na(result$probability)) {
      paste("Probability of being Male:", round(result$probability * 100, 2), "%")
    }
  })
}

# Run the application
shinyApp(ui = ui, server = server)

shiny::runApp("app.R")
```

## How to Use This Tool

1. Select a morphometric trait from the dropdown menu (e.g., chord length, head length, or culmen length).

2. Measure the selected trait on the bird using calipers or another reliable tool.

3. Enter the measurement into the input field.

4. Click the “Predict Sex” button to calculate the probability of the bird being male or female.

## Important Notes:

The accuracy of the prediction depends on the precision of your measurement.

The tool is designed for Leach’s Storm-Petrels and may not perform well on other species or populations with different morphometric characteristics.

This tool is intended as a supplementary resource and should not replace molecular sexing methods for critical scientific studies.
